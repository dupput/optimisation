
fun = @(x) -(x(2)+47)*sin(sqrt(abs(x(1)/2 + (x(2)+47)))) - x(1)*sin(sqrt(abs(x(1)-(x(2)+47))));

lb = [-512 -512];
ub = [512 512];
[x,fval] = ga(fun,2,[],[],[],[],lb,ub,[],options);

options = optimoptions('ga','ConstraintTolerance',1e-6, ...
    'PopulationSize',1000,'EliteCount', 1, 'PlotFcn','gaplotbestf','MutationFcn', {@mutationuniform, 1})
% [x,fval] = ga(fun,2,[],[],[],[],lb,ub,[],options);

avgs = [];
rates = [1 2 3 4 5];
for mute = rates
    % Data columns are x1, x2, fval, time
    data = zeros(10, 4);
    
    options = optimoptions('ga','ConstraintTolerance',1e-6, ...
    'PopulationSize',1000,'EliteCount', 1, 'PlotFcn','gaplotbestf','MutationFcn', ...
    {@mutationuniform, mute});
    
    fvals = []
    for i = 1:5
        tic
        [x,fval] = ga(fun,2,[],[],[],[],lb,ub,[],options);
        et = toc;
        fvals(end+1) = fval;
    end
    avgs(end+1) = mean(fvals);
end
plot(rates, avgs)
    %%
mute_off = [511.999999964480	404.231821277277	-959.640662600297	0.834226700000000
482.372410715853	432.898578952507	-956.918155033215	2.06875760000000
482.353359334948	432.879046755079	-956.918231624201	0.854361900000000
482.353311607181	432.879001005501	-956.918231624645	0.762397300000000
482.353330042559	432.879016620818	-956.918231624514	0.691799800000000
511.999999996934	404.231808594085	-959.640662710457	1.00712540000000
511.999995529633	404.231842970993	-959.640647584111	0.813375800000000
511.999999799895	404.231818832556	-959.640662043162	1.23010510000000
482.353689165310	432.879368899022	-956.918231596638	2.59079660000000
511.999999994979	404.231807884157	-959.640662703843	0.816069300000000];

mute_on = [439.480994853186	453.977431397666	-935.337951560578	1.84587270000000
511.999999998596	404.231807747930	-959.640662716089	2.16748550000000
482.353298692421	432.878987277901	-956.918231624640	4.79483010000000
482.353340394720	432.879029205919	-956.918231624492	3.00622410000000
479.083383513270	434.543634215100	-955.254880661566	5.32135050000000
479.045216439683	434.505692071070	-955.255152137614	5.32555880000000
511.999999462279	404.231928533390	-959.640660882907	2.25218180000000
511.999999891079	404.231805728517	-959.640662352090	2.03154670000000
439.481003636766	453.977442047574	-935.337951560570	1.81732900000000
479.045449780632	434.505919549439	-955.255152143742	1.70171680000000];

% %% close all
% figure
% grid on;
% plot([-959.6407, -959.6407], [0, 2.5], 'r', 'LineWidth',1)
% hold on
% plot(mute_on(:,3), mute_on(:,4), '.', 'MarkerSize',10)
% plot(mute_off(:,3), mute_off(:,4), '.', 'MarkerSize',10)
% % % plot(pop2000(:,3), pop2000(:,4), '.', 'MarkerSize',10)
% % % plot(dataStruct.Population_200(:,3), dataStruct.Population_200(:,4), '.', 'MarkerSize',10)
% % 
% avg = mean(mute_on(:,3));
% plot([avg, avg], [0, 2.5], 'LineWidth',1)
% % 
% avg = mean(mute_off(:,3));
% plot([avg, avg], [0, 2.5], 'LineWidth',1)
% % 
% % avg2000 = mean(pop2000(:,4));
% % plot([avg2000, avg2000], [0, 2.5], 'LineWidth',1)
% % 
% % xlim([-1000, -850])
% legend('Target', 'mutation on', 'mutation off')



% pop2000 = [482.353347534883	432.879036212712	-956.918231624404	1.93813130000000
% 482.353310440343	432.878999152116	-956.918231624664	2.23974130000000
% 511.999999951022	404.231808568275	-959.640662555020	1.66820890000000
% 511.999999972251	404.231794414254	-959.640662626773	1.67052470000000
% 482.353357146455	432.879045651924	-956.918231624255	1.47481130000000
% 482.353291132242	432.878979292998	-956.918231624591	1.69894500000000
% 511.999999996273	404.231808141431	-959.640662708223	1.80420280000000
% 511.999999783823	404.231804941022	-959.640661988969	1.59917370000000
% 482.353359085635	432.879048893067	-956.918231624162	1.64323190000000
% 439.481027948691	453.977465092526	-935.337951560398	1.47284920000000];
% 
% pop1000 = [479.045374313659	434.505843464559	-955.255152143820	1.96730410000000
% 511.999999994167	404.231804957669	-959.640662701103	0.783267400000000
% 482.358142645407	432.883895955705	-956.918227048369	1.67136940000000
% 511.999999995947	404.231807959236	-959.640662707120	0.674835600000000
% 479.043045999808	434.503374766107	-955.255150502242	1.33073020000000
% 511.999999957886	404.231791437960	-959.640662578060	0.784003800000000
% 511.999999985633	404.231793130081	-959.640662672048	0.770345700000000
% 482.353868209820	432.879533118525	-956.918231555856	0.817144100000000
% 511.999998223959	404.231928229468	-959.640656690257	0.863991400000000
% 511.999998291506	404.231833081743	-959.640656935634	0.954773300000000];
% 
% pop500 = [482.353361623831	432.879050106329	-956.918231624173	0.351435000000000
% 347.327029506557	499.415440649126	-888.949125269374	0.314000200000000
% 439.480951276851	453.977409390330	-935.337951559995	0.354169200000000
% 511.999999985834	404.231798789334	-959.640662672847	0.384418700000000
% 439.480984022149	453.977421978719	-935.337951560547	0.342257100000000
% -465.694155577308	385.716700618891	-894.578900390598	0.326106000000000
% 479.048695054331	434.509165067290	-955.255150100644	0.363151000000000
% 482.358295500831	432.884005982328	-956.918226907972	0.410490000000000
% 439.481054578640	453.977483317050	-935.337951559991	0.288440300000000
% 511.999999245029	404.230873917197	-959.640659180503	0.392281300000000];


